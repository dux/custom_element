// Generated by CoffeeScript 2.4.1
// Svelte('dialog', function(){
//   this.close()
//   window.$.delay(()=>{ window.scrollTo(0, 0) })
// })
window.Svelte = function(name, func) {
  var el;
  if (name.includes('*')) {
    if (!func) {
      console.error(`Svelte component glob "${name}*", func not defined`);
    }
    // if giver * glob all execute function
    // Svelte 'filter*', (el) -> el.close()
    name = name.replace('*', '');
    Array.prototype.slice.call(document.getElementsByTagName(`s-${name}`)).forEach(function(el) {
      return func.bind(el.svelte)();
    });
  }
  if (el = document.getElementsByTagName(`s-${name}`)[0]) {
    if (func) {
      return func.bind(el.svelte)();
    } else {
      return el.svelte;
    }
  } else {
    if (!func) {
      return console.error(`Svelte component "${name}" not found`);
    }
  }
};

// bind Svelte elements
Object.assign(Svelte, {
  cnt: 0,
  nodesAsList: function(root) {
    var list;
    list = [];
    root.childNodes.forEach(function(node, i) {
      var a, j, len, o, ref;
      if (node.attributes) {
        o = {};
        o.HTML = node.innerHTML;
        o.ID = i + 1;
        ref = node.attributes;
        for (j = 0, len = ref.length; j < len; j++) {
          a = ref[j];
          o[a.name] = a.value;
        }
        return list.push(o);
      }
    });
    return list;
  },
  // bind custom node to class
  bind: function(name, klass) {
    return CustomElement.define(name, function(node, opts) {
      var element, global;
      if (node.innerHTML) {
        if (node.innerHTML.indexOf('</slot>') > -1) {
          opts.slots = Svelte.nodesAsList(node);
        } else {
          opts.innerHTML = node.innerHTML;
          node.innerHTML = '';
        }
      }
      global = null;
      if (opts.global) {
        global = opts.global;
        delete opts.global;
      }
      element = new klass({
        target: node,
        props: opts
      });
      if (global) {
        window[global] = element;
      }
      return node.svelte = element;
    });
  }
});

export default Svelte;
